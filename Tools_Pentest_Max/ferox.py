import subprocess

# Solicitar la dirección IP al usuario
ip = input("Introduce la dirección IP (ej. 192.168.1.1): ")

# Solicitar el protocolo (http o https)
protocol = input("Seleccione el protocolo (http o https): ")

# Solicitar el puerto
port = input("Introduce el puerto (ej. 80): ")

# Construir la URL completa con el protocolo y el puerto
url = f"{protocol}://{ip}:{port}"

print("Lanzando feroxbuster contra la URL:", url)

# Configurar los parámetros de feroxbuster sin el argumento --status-codes y sin crear archivos .state
ferox_params = [
    "feroxbuster",
    "-u", url,
    "-w", "/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt",
    "--threads", "50",
    "--timeout", "7",
    "--user-agent", "feroxbuster/2.10.0",
    "--extract-links",
    "--methods", "GET",
    "--depth", "4",
    "--no-state", # Evita la creación de archivos .state
    "-x", ".js,.txt,.php,.html" # Lista de extensiones a buscar
]

# Ejecutar feroxbuster con los parámetros especificados
subprocess.run(ferox_params)

print("Fuzzing finalizado")
