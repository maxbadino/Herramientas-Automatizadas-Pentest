import os

# Diccionario de configuración
dictionary_path = "/usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt"

def get_user_input():
    ip_or_domain = input("Ingresa la IP o el dominio: ")
    port = input("Ingresa el puerto: ")
    protocol = input("Ingresa el protocolo (http o https): ").lower()

    if protocol not in ["http", "https"]:
        print("Protocolo inválido. Usa 'http' o 'https'.")
        return None, None, None, None

    filter_size = input("¿Deseas filtrar por tamaño de respuesta? Ingresa el tamaño o presiona Enter para no aplicar filtro: ")

    return ip_or_domain, port, protocol, filter_size

def run_ffuf(ip_or_domain, port, protocol, filter_size):
    url = f"{protocol}://{ip_or_domain}:{port}"
    host_header = f"Host: FUZZ.{ip_or_domain}"
    
    # Comando base con filtro de código de estado 200
    command = f"ffuf -u {url} -H \"{host_header}\" -w {dictionary_path} -mc 200"
    
    # Aplicar filtro de tamaño de respuesta si se indicó
    if filter_size.isdigit():
        command += f" -fs {filter_size}"
    
    print(f"Ejecutando: {command}")
    os.system(command)

if __name__ == "__main__":
    ip_or_domain, port, protocol, filter_size = get_user_input()
    if ip_or_domain and port and protocol:
        run_ffuf(ip_or_domain, port, protocol, filter_size)
