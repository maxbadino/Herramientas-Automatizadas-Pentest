import subprocess

def run_ffuf(ip, dictionary, filter_status=None, threads=10):
    command = f"ffuf -u http://{ip}/FUZZ -w {dictionary}"
    if filter_status:
        command += f" -fc {filter_status}"
    command += f" -t {threads}"
    subprocess.call(command, shell=True)

def main():
    ip = input("Ingrese la dirección IP: ")
    change_dict = input("¿Desea cambiar el diccionario directory-medium? (s/n): ")

    if change_dict.lower() == "s":
        new_dict = input("Ingrese la ruta del nuevo diccionario: ")
        hide_status = input("¿Desea ocultar algún tipo de código de estado? (s/n): ")
        if hide_status.lower() == "s":
            filter_status = input("Ingrese los códigos de estado separados por comas (por ejemplo: 301,403,500): ")
            threads = int(input("Ingrese la cantidad de hilos (threads): "))
            run_ffuf(ip, new_dict, filter_status, threads)
        else:
            threads = int(input("Ingrese la cantidad de hilos (threads): "))
            run_ffuf(ip, new_dict, threads=threads)
    else:
        dictionary = "/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt"
        hide_status = input("¿Desea ocultar algún tipo de código de estado? (s/n): ")
        if hide_status.lower() == "s":
            filter_status = input("Ingrese los códigos de estado separados por comas (por ejemplo: 301,403,500): ")
            threads = int(input("Ingrese la cantidad de hilos (threads): "))
            run_ffuf(ip, dictionary, filter_status, threads)
        else:
            threads = int(input("Ingrese la cantidad de hilos (threads): "))
            run_ffuf(ip, dictionary, threads=threads)

if __name__ == "__main__":
    main()
